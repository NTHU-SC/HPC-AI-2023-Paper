\section{Experimental Setup}
\label{sec:exp-setup}

\subsection{Hardware configuration}
Our testing environment comprises the GADI system at the National Computational Infrastructure(NCI) in Singapore, the ASPIRE 2A system  at  the National Supercomputing Centre (NSCC) in Singapore and the Taiwania 3 system at the National Center for High-performance Computing (NCHC) in Taiwan . In the context of the MPAS-Atmosphere application, we utilized the normal queue on GADI and Taiwania 3. Additionally, on the other hand, for Bloom application, we employed the gpuvolta queue on GADI and Taiwania 2, while opting for the normal queue on the ASPIRE 2A system.

\begin{table*}[t]
    \centering
    \caption{The cluster hardware configuration}
    \begin{tabular}{l|llll}
        \toprule
        Type & GADI & Taiwania 3  & Taiwania 2 & ASPIRE 2A\\
        \midrule
        CPU model & Intel Xeon Platinum 8274 & Intel Xeon Platinum 8280 & Intel Xeon Gold 6154 & CPU AMD EPYC 7713\\
        CPU micro architecture & Cascade Lake & Cascade Lake & Skylake & Millan \\
        CPU frequency & 3.2 GHz & 2.4 GHz & 3.0 GHz & 2 GHz\\
        Cores per CPU & 24 & 28 & 18 & 32\\
        Numbers of CPU per node & 2 & 2 & 2 & 2\\
        RAM per node & 192GB & 192GB & 192GB &  512 GB   \\
        GPUs per node &  4 $\times$ NVIDIA V100 & Not Available & 8 $\times$ NVIDIA V100 & 4 $\times$ NVIDIA A100 \\
        Infiniband    & 200 Gb/s & 100 Gb/s & 100 Gb/s  \\
        \bottomrule
    \end{tabular}
    \label{table:hardware}
\end{table*}

Table~\ref{table:hardware} summarizes some detailed hardware configurations. Our final result for MPAS-A consists of 32 CPU nodes with 48 CPU cores on each nodes, for Bloom inference, we utilized a total of 8 V100 GPUs distributed across two nodes on both GADI and Taiwania 2. Additionally,8 A100 GPUs were employed on two nodes on NSCC. . 


\subsection{Software Configuration}
Table~\ref{table:software-CPU} lists the software installed on both the GADI and Taiwania 3 cluster, which is mainly used for MPAS-A application, moreover, we have Rocky Linux as operating system on GADI and CentOS on Taiwania 3.

\begin{table}[ht]
    \centering
    \caption{The cluster software configuration for MPAS-A}
    \begin{tabular}{ll}
        \toprule
        Libraries & Versions  \\
        \midrule
        C Compiler & ICC 2021.10.0 \\
        MPI Library & OpenMPI 4.1.5 \\
        HDF5 & 1.8.18 \\
        PNETCDF & 1.12.3 \\
        NETCDF C & 4.8.1 \\
        NETCDF Fortran & 4.6.1 \\
        Parallel I/O & 2.5.10 \\
        Metis & 5.1.0 \\
        \bottomrule
    \end{tabular}
    \label{table:software-CPU}
\end{table}

Table~\ref{table:software-GPU} lists the software required from Bloom and installed on both the GADI ,Aspire2A and Taiwania 2 cluster. Furthermore, ASPIRE 2A use Red Hat Enterprise Linux 8 (RHEL) as operating system and Taiwania 2 use CentOS as operating system.

\begin{table}[ht]
    \centering
    \caption{The cluster software configuration for Bloom}
    \begin{tabular}{ll}
        \toprule
        Libraries & Versions  \\
        \midrule
        C Compiler & GCC 10.3.0 \\
        GPU Compiler & CUDA nvcc 11.6 \\
        python & 3.8 \\
        NCCL & 2.18 \\
        Pytorch & 1.12.1 \\
        Transformer & 4.26.1 \\
        Deepspeed & 0.7.6 \\
        accelerate & 0.16.0  \\
        gunicorn & 20.1.0 \\
        uvicorn & 0.19.0 \\
        jinja2 & 3.1.2 \\
        pydantic & 1.10.2 \\
        huggingface hub & 0.12.1 \\
        grpcio-tools & 1.50.0 \\
        bitsandbytes & 0.41.1 \\

        \bottomrule
    \end{tabular}
    \label{table:software-GPU}
\end{table}